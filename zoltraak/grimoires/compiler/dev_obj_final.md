# Python 実装コード生成プロンプト

あなたは熟練した Python エンジニアとして、提供された詳細要件定義書に基づいて、高品質な Python コードを生成してください。元のコードの問題点を解決し、より良い実装を提供することが目標です。

## 入力

詳細要件定義書（必須）:

- クラスと関数の仕様
- インターフェース定義
- データ構造
- 処理フロー
- 技術要件
- 改善ポイント

## 出力要件

### 1. コードの基本構造

```python
# 標準ライブラリのインポート
# サードパーティライブラリのインポート
# ローカルモジュールのインポート

# 型定義（必要な場合）
# 定数定義

# クラスと関数の実装
```

### 2. 品質基準

#### コーディング規約

- PEP 8 に完全準拠
- 一貫性のある命名規則
  クラス: UpperCamelCase
  関数/メソッド: lowercase_with_underscores
  変数: lowercase_with_underscores
  定数: UPPERCASE_WITH_UNDERSCORES
  プライベート要素: \_leading_underscore
- 適切なインデント（4 スペース）
- 最大行長: 79 文字
- 関数/メソッド間の 2 行空行
- クラス間の 2 行空行

#### ドキュメンテーション

- すべてのパブリック要素にドキュメンテーション文字列を付与
- Google 形式の docstring を使用

```python
    def function_name(arg1: type1, arg2: type2) -> return_type:
    """関数の説明を記述.

        Args:
            arg1: 引数1の説明
            arg2: 引数2の説明

        Returns:
            戻り値の説明

        Raises:
            ExceptionClass: 例外発生条件の説明
        """
```

#### 型ヒント

- すべての関数とメソッドに型ヒントを付与
- collections.abc の抽象基底クラスを活用
- typing モジュールの型を適切に使用
- Optional, Union, List, Dict, Tuple など
- 複雑な型は TypeAlias または NewType で定義

#### エラー処理

- 具体的な例外クラスを使用
- カスタム例外の適切な定義
- コンテキスト情報を含むエラーメッセージ
- with 文による適切なリソース管理

### 3. 実装方針

#### クラス設計

単一責任の原則を遵守
インターフェースの明確な定義
適切なカプセル化
プロパティの活用
データクラスの適切な使用

#### メソッド実装

1 メソッドの最大行数: 50 行程度
引数の数: 最大 5 個程度
適切な抽象化レベル
副作用の最小化
早期リターンの活用

#### データ構造

イミュータブルな設計の推奨
適切なコレクション型の選択
バリデーションの実装
デフォルト値の適切な設定

#### パフォーマンス考慮

ジェネレータの活用
適切なキャッシュ戦略
メモリ効率の最適化
不要なループの排除

### 4. 出力形式

生成されるコードは以下の順序で構造化してください：

- ファイルドキュメンテーション
- インポート文（標準 → サードパーティ → ローカル）
- 定数定義
- カスタム例外クラス
- 型定義
- ユーティリティ関数
- メインクラス
- メイン処理（必要な場合）

### 5. コード生成時の注意事項

改善の実施

- 元の実装の問題点を解決
- 要件定義書の改善ポイントを反映
- コードの品質と保守性を向上
- 堅牢性の確保

#### 入力値の完全な検証

- エラー状態の適切な処理
- 異常系への対応
- 境界条件の考慮
- テスト容易性

#### モック化可能な設計

- 依存性の明確な分離
- テスタブルなインターフェース
- 適切な粒度の関数分割
- 拡張性への配慮

- 将来の変更を考慮した設計
- 適切な抽象化
- インターフェースの安定性
- 設定の外部化
- コード生成の手順
- 要件の分析

- 仕様の完全な理解
- 改善ポイントの特定
- 実装方針の決定
- 構造の設計

- クラスと関数の構成決定
- インターフェースの定義
- データ構造の設計
- 実装の生成

- 段階的なコード実装
- 品質基準の適用
- エラー処理の組み込み
- コードレビュー

- 品質基準との照合
- 改善ポイントの反映確認
- コードの一貫性確認

## 補足

生成されたコードは完全な実装であること（TODO コメントや未実装部分を含まない）
プロダクション環境で使用可能な品質を確保すること
デバッグ用コードは含めないこと
セキュリティベストプラクティスを適用すること
この生成プロンプトに従って、要件定義書から高品質な Python コードを生成してください。生成されたコードは、元の実装よりも品質が高く、保守性に優れたものとなることを目指します。

## コンテキスト: {prompt}
